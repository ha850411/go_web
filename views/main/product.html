<!--引入共用模板-->
{{ template "layout.html" .}}
{{ define "content" }}
<div class="main">
  <!-- MAIN CONTENT -->
  <div class="main-content">
    <div class="container-fluid">
      <h3 class="page-title">存貨管理</h3>
      <div class="panel panel-headline">
        <div class="panel-body">
            <button type="button" id="addProductBtn" class="btn btn-primary" style="margin-bottom: 10px;">新增產品</button>
            <!-- data table -->
            <table id="productTable" class="table table-striped table-bordered dt-responsive nowrap" style="width:100%">
            </table>
            <table id="loadingTable">
                <tr>
                    <td align="center"><i class="fa fa-spinner fa-spin" style="font-size:20px;"></i><span style="margin-left:3px;">載入中...</span></td>
                </tr>
            </table>
        </div>
      </div>
    </div>
  </div>
  <!-- END MAIN CONTENT -->
</div>

<script>
var  productTable;
$(function(){
    // init
    productTable = initProductTable();

    $('#addProductBtn').click(function(){
        $('#productModal').modal('show');
    });

});

function updateAmount(id)
{
    $.ajax({
        type: 'PUT',
        url: '/api/products/updateAmount',
        dataType: 'json',
        data: { 
            id: id,
            amount: $('.amountInput[data-id="'+id+'"]').val()
        },
        beforeSend: function(){
            $('.statusIcon').css("display", "none");
            $('.msgItem').css("display", "none");
            $('.mdfBtn_'+id).css("display", "none");
            $('.loading_'+id).css("display", "block");
        },
        success: function (result, statusText, xhr) {
            $('.success_'+id).css("display", "block");
            $('.success_'+id).fadeOut(3000);
        },
        error: function (err) {
            $('.msgItem').css("display", "block");
            $('.msg_'+id).html(err.responseJSON.msg);
            $('.failed_'+id).css("display", "block");
            $('.failed_'+id).fadeOut(3000);
            $('.msgItem').fadeOut(3000);
        },
        complete: function(){
            console.log('complete');
            $('.mdfBtn_'+id).css("display", "block");
            $('.loading_'+id).css("display", "none");
        }
    });
}

function ListenInput(event, id) {
    val = event.target.value;
    console.log(val);
    $('.amountInput[data-id="'+id+'"]').each(function(){
        $(this).val(val);
    });
}
</script>
{{end}}